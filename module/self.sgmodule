#!name=自用模块（拆分版）
#!desc=从自用.conf拆出的可订阅模块：Host + Rule + URL Rewrite + MITM hostname（不含证书私钥）

[Host]
# 域名指定本地值：
# example.com = 1.2.3.4

# 域名指定 DNS 服务器：
# example.com = server:1.2.3.4

# wifi名称指定 DNS 服务器，如需指定多个 DNS，可用逗号分隔：
# ssid:wifi名称 = server:1.2.3.4

*.apple.com = server:system
*.icloud.com = server:system
localhost = 127.0.0.1

[Rule]
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/AD.rule,AD
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/Ibank.rule,IBANK
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/AI.rule,AI
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/eBay.rule,EBAY
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/paypal.rule,PAYPAL
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/Ins-tok-face-X.rule,INSFACXTOK
RULE-SET,https://raw.githubusercontent.com/hxn996/loon-rules/refs/heads/main/rules/apple.rule,APPLE
# 规则类型：
# DOMAIN-SUFFIX：匹配请求域名的后缀。如“DOMAIN-SUFFIX,example.com,DIRECT”可以匹配到“a.example.com、a.b.example.com”。
# DOMAIN-KEYWORD：匹配请求域名的关键词。如“DOMAIN-KEYWORD,exa,DIRECT”可以匹配到“a.example.com、a.b.example.com”。
# DOMAIN：匹配请求的完整域名。如“DOMAIN,www.example.com,DIRECT”只能匹配到“www.example.com”。
# （当为DOMAIN、DOMAIN-SUFFIX和DOMAIN-KEYWORD类型分别设置相同的值时，只有其中一种类型会生效。）
# USER-AGENT：匹配用户代理字符串，支持使用通配符“*”。如“USER-AGENT,MicroMessenger*,DIRECT”可以匹配到“MicroMessenger Client”。
# URL-REGEX：匹配URL正则式。如“URL-REGEX,^https?://.+/item.+,REJECT”可以匹配到“https://www.example.com/item/abc/123”。
# IP-CIDR：匹配IPv4或IPv6地址。如“IP-CIDR,192.168.1.0/24,DIRECT”可以匹配到IP段...IDR,172.16.0.0/12,DIRECT,no-resolve)，则域名请求将会跳过此规则，不会触发本地 DNS 查询。
# IP-ASN：匹配IP地址隶属的ASN编号。如"IP-ASN,56040,DIRECT"可以匹配到属于China Mobile Communications Corporation网络的IP地址。
...
# 3.域名规则优先于IP规则。

# 关于屏蔽443端口的UDP流量的解释内容：HTTP3/QUIC协议开始流行，但是国内ISP和国际出口的UDP优先级都很低，表...释符号#。另外可以在 General 中使用 block-quic=all-proxy|all|always-allow 命令）
# AND,((PROTOCOL,UDP),(DST-PORT,443)),REJECT-NO-DROP

# 国外常用服务单独分流：YouTube，Netflix，Disney+，Max（HBO），Spotify，Telegram，P...er，Facebook，Google，TikTok，GitHub，AI（ChatGPT、Gemini、Claude、Grok）。
# 国内常用服务单独分流：苹果服务，微软服务，哔哩哔哩，网易云音乐，游戏平台，亚马逊，百度，豆瓣，微信，抖音，新浪，知乎，小红书。

# 本地局域网地址的规则集。

# 表示CN地区的IP分流走直连，GEOIP数据库用来判断IP是否属于CN地区。默认使用Shadowrocket自带的GEOIP数据库，如果您想替换其他数据库，可在 设置 - GeoLite2数据库 里添加和修改。
GEOIP,cn,CN,DIRECT

# 表示当其他所有规则都匹配不到时才使用FINAL规则的策略。
FINAL,PROXY

[URL Rewrite]
# Google搜索引擎防跳转的重写。
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302

[MITM]
enable = true
# Shadowrocket仅会解密hostname指定的域名的请求，可以使用通配符。也可以使用前缀 - 排除特定主机名，如 -...用有严格的安全策略，仅信任某些特定的证书，对这些域名启动解密可能导致问题，如 *.apple.com，*.icloud.com。

hostname = *.google.cn